<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get_Start â€¢ itol.toolkit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get_Start">
<meta property="og:description" content="itol.toolkit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">itol.toolkit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Get_Start.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Single Functions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Tree Structure</li>
    <li>
      <a href="../articles/COLLAPSE.html">COLLAPSE</a>
    </li>
    <li>
      <a href="../articles/PRUNE.html">PRUNE</a>
    </li>
    <li>
      <a href="../articles/SPACING.html">SPACING</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Theme Style</li>
    <li>
      <a href="../articles/TREE_COLORS.html">TREE_COLORS</a>
    </li>
    <li>
      <a href="../articles/DATASET_STYLE.html">DATASET_STYLE</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Text</li>
    <li>
      <a href="../articles/LABELS.html">LABELS</a>
    </li>
    <li>
      <a href="../articles/DATASET_TEXT.html">DATASET_TEXT</a>
    </li>
    <li>
      <a href="../articles/DATASET_COLORSTRIP.html">DATASET_COLORSTRIP</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Basic Plot</li>
    <li>
      <a href="../articles/DATASET_BINARY.html">DATASET_BINARY</a>
    </li>
    <li>
      <a href="../articles/DATASET_GRADIENT.html">DATASET_GRADIENT</a>
    </li>
    <li>
      <a href="../articles/DATASET_HEATMAP.html">DATASET_HEATMAP</a>
    </li>
    <li>
      <a href="../articles/DATASET_SYMBOL.html">DATASET_SYMBOL</a>
    </li>
    <li>
      <a href="../articles/DATASET_EXTERNALSHAPE.html">DATASET_EXTERNALSHAPE</a>
    </li>
    <li>
      <a href="../articles/DATASET_DOMAINS.html">DATASET_DOMAINS</a>
    </li>
    <li>
      <a href="../articles/DATASET_SIMPLEBAR.html">DATASET_SIMPLEBAR</a>
    </li>
    <li>
      <a href="../articles/DATASET_MULTIBAR.html">DATASET_MULTIBAR</a>
    </li>
    <li>
      <a href="../articles/DATASET_BOXPLOT.html">DATASET_BOXPLOT</a>
    </li>
    <li>
      <a href="../articles/DATASET_LINECHART.html">DATASET_LINECHART</a>
    </li>
    <li>
      <a href="../articles/DATASET_PIECHART.html">DATASET_PIECHART</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced Plot</li>
    <li>
      <a href="../articles/DATASET_ALIGNMENT.html">DATASET_ALIGNMENT</a>
    </li>
    <li>
      <a href="../articles/DATASET_CONNECTIONS.html">DATASET_CONNECTIONS</a>
    </li>
    <li>
      <a href="../articles/DATASET_IMAGE.html">DATASET_IMAGE</a>
    </li>
    <li>
      <a href="../articles/POPUP_INFO.html">POPUP_INFO</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tips
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/OVERVIEW_TREE_STRUCTURE.html">Overview</a>
    </li>
    <li>
      <a href="../articles/Installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/Datasets.html">Datasets</a>
    </li>
    <li>
      <a href="../articles/Color_Palette.html">Colors</a>
    </li>
    <li>
      <a href="../articles/Data_Reproduction.html">Data Reproduction</a>
    </li>
    <li>
      <a href="../articles/Comparison_table2itol.html">vs table2itol</a>
    </li>
    <li>
      <a href="../articles/tree_construction.html">Tree Construction</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Version history</li>
    <li>
      <a href="../articles/v1.1.9.html">version 1.1.9</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://tongzhou2017.github.io/itol.toolkit-gallery/" class="external-link">Gallery</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TongZhou2017/itol.toolkit" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discord.com/invite/n5TC7jCfGJ" class="external-link">
    <span class="fab fa-discord fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/itol_toolkit" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get_Start</h1>
            
      
      
      <div class="hidden name"><code>Get_Start.Rmd</code></div>

    </div>

    
    
<p>In this tutorial, we use the iTOL template structure and usage data
to show itol.toolkit basic workflow. The tree file is generated by
weighted clustering based on template parameters.</p>
<p>The following packages are used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">itol.toolkit</span><span class="op">)</span> <span class="co"># main package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span> <span class="co"># file read</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span> <span class="co"># tree operation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span> <span class="co"># string operation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span> <span class="co"># data manipulation</span></span></code></pre></div>
<div class="section level2">
<h2 id="data-paraperation">Data paraperation<a class="anchor" aria-label="anchor" href="#data-paraperation"></a>
</h2>
<p>The tree file is a built-in file in the package, which can be located
by the <code>system.file</code> function. Users can find the file in the
path and upload it to iTOL as the main tree.</p>
<p>The template_groups data contains the 23 templatesâ€™ name and their
types. We cluster the template types based on the parameter similarity
and function type.</p>
<p>The template_parammeters_count data contains the template usage count
in public papers. We searched the data from GitHub or requests from
authors.</p>
<p>Here is an example of 9 annotation datasets. Run the code block to
get the datasets.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"tree_of_itol_templates.tree"</span>,package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"template_groups"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"template_parameters_count"</span><span class="op">)</span></span>
<span><span class="va">hub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_hub.html">create_hub</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 1,7 data</span></span>
<span><span class="va">df_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">template_groups</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>, </span>
<span>                       data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">template_groups</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 2 data</span></span>
<span><span class="va">df_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">template_groups</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">template_parameters_count</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 3 data</span></span>
<span><span class="va">df_rename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">template_groups</span><span class="op">$</span><span class="va">template</span>, </span>
<span>                        new_label <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="va">template_groups</span><span class="op">$</span><span class="va">template</span>,<span class="st">"_"</span>,<span class="st">" "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 5 data</span></span>
<span><span class="va">tab_tmp_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">template_parameters_count</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tab_tmp_connect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_01_to_connect.html">convert_01_to_connect</a></span><span class="op">(</span><span class="va">tab_tmp_01</span><span class="op">)</span></span>
<span><span class="va">tab_tmp_connect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">tab_tmp_connect</span>, <span class="va">template_groups</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span> <span class="op">=</span> <span class="st">"template"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tab_tmp_connect</span> <span class="op">&lt;-</span> <span class="va">tab_tmp_connect</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">val</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row</span> <span class="op">!=</span> <span class="va">col</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 6 data</span></span>
<span><span class="va">tab_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"parameter_groups.txt"</span>,package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tab_id_group</span> <span class="op">&lt;-</span> <span class="va">tab_tmp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">tab_tmp</span> <span class="op">&lt;-</span> <span class="va">tab_tmp</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">tab_tmp_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_01.html">convert_01</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tab_tmp</span><span class="op">)</span></span>
<span><span class="va">tab_tmp_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">tab_id_group</span>,<span class="va">tab_tmp_01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"type"</span>,<span class="st">"separator"</span>,<span class="st">"profile"</span>,<span class="st">"field"</span>,<span class="st">"common themes"</span>,<span class="st">"specific themes"</span>,<span class="st">"data"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tab_tmp_01_long</span> <span class="op">&lt;-</span> <span class="va">tab_tmp_01</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"variable"</span>,value <span class="op">=</span> <span class="st">"value"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">parameter</span>,<span class="op">-</span><span class="va">group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">template_start_group</span> <span class="op">&lt;-</span> <span class="va">tab_tmp_01_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group</span>,<span class="va">variable</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>sublen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span>key<span class="op">=</span><span class="va">variable</span>,value<span class="op">=</span><span class="va">sublen</span><span class="op">)</span></span>
<span><span class="va">template_start_group</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">template_start_group</span><span class="op">$</span><span class="va">group</span>,levels <span class="op">=</span> <span class="va">order</span><span class="op">)</span></span>
<span><span class="va">template_start_group</span> <span class="op">&lt;-</span> <span class="va">template_start_group</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">start_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Var1 <span class="op">=</span> <span class="va">template_start_group</span><span class="op">$</span><span class="va">group</span>, Freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">template_start_group</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">start_group</span><span class="op">$</span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">start_group</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">start_group</span><span class="op">$</span><span class="va">start</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">start_group</span><span class="op">$</span><span class="va">Freq</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">template_start_group</span><span class="op">[</span><span class="va">template_start_group</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">template_end_group</span> <span class="op">&lt;-</span> <span class="va">template_start_group</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">template_start_group</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="va">start_group</span><span class="op">$</span><span class="va">start</span></span>
<span><span class="va">template_end_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">order</span>,<span class="va">template_end_group</span><span class="op">)</span></span>
<span><span class="va">template_end_group_long</span> <span class="op">&lt;-</span> <span class="va">template_end_group</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"variable"</span>,value <span class="op">=</span> <span class="st">"value"</span>,<span class="op">-</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">template_end_group_long</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"end"</span></span>
<span><span class="va">template_end_group_long</span><span class="op">$</span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">start_group</span><span class="op">$</span><span class="va">start</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">template_end_group_long</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">template_end_group_long</span> <span class="op">&lt;-</span> <span class="va">template_end_group_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">template_end_group_long</span><span class="op">$</span><span class="va">length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">start_group</span><span class="op">$</span><span class="va">Freq</span><span class="op">)</span></span>
<span><span class="va">template_end_group_long</span> <span class="op">&lt;-</span> <span class="va">template_end_group_long</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">template_end_group_long</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">template_end_group_long</span><span class="op">$</span><span class="va">group</span>,levels <span class="op">=</span> <span class="va">order</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 8 data</span></span>
<span><span class="va">df_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"templates_frequence.txt"</span>,package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"Li,S. et al. (2022) J. Hazard. Mater."</span>,<span class="st">"Zheng,L. et al. (2022) Environ. Pollut."</span>,<span class="st">"Welter,D.K. et al. (2021) mSystems"</span>,<span class="st">"Zhang,L et al. (2022) Nat. Commun."</span>,<span class="st">"Rubbens,P. et al. (2019) mSystems"</span>,<span class="st">"Laidoudi,Y. et al. (2022) Pathogens"</span>,<span class="st">"Wang,Y. et al. (2022) Nat. Commun."</span>,<span class="st">"Ceres,K.M. et al. (2022) Microb. Genomics"</span>,<span class="st">"Youngblut,N.D. et al. (2019) Nat. Commun."</span>,<span class="st">"BalvÃ­n,O. et al. (2018) Sci. Rep."</span>,<span class="st">"Prostak,S.M. et al. (2021) Curr. Biol."</span>,<span class="st">"Dijkhuizen,L.W. et al. (2021) Front. Plant Sci."</span>,<span class="st">"Zhang,X. et al. (2022) Microbiol. Spectr."</span>,<span class="st">"Peris,D. et al. (2022) PLOS Genet."</span>,<span class="st">"Denamur,E. et al. (2022) PLOS Genet."</span>,<span class="st">"Dezordi,F.Z. et al. (2022) bioRxiv"</span>,<span class="st">"Lin,Y. et al. (2021) Microbiome"</span>,<span class="st">"Wang,Y. et al. (2022) bioRxiv"</span>,<span class="st">"Qi,Z. et al. (2022) Food Control"</span>,<span class="st">"Zhou,X. et al. (2022) Food Res. Int."</span>,<span class="st">"Zhou,X. et al. (2022) Nat. Commun."</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove_all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_values</span><span class="op">)</span>,<span class="st">"[()]"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_values</span><span class="op">)</span>,<span class="st">","</span>,<span class="st">"-"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## 9 data</span></span>
<span><span class="va">df_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"templates_frequence.txt"</span>,package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_value</span> <span class="op">&lt;-</span> <span class="va">df_value</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">templates</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">templates</span>,<span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df_value</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">df_value</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-unit">Create unit<a class="anchor" aria-label="anchor" href="#create-unit"></a>
</h2>
<p>Using default themes to create the unit object by the
<code>create_unit</code> function. For most template types only need two
columns of data. The other data can be defined by parameter or
auto-identified by programming.</p>
<p>The data is for annotation datasets in data frame format. The key is
for the output file name if all units are merged into the hub and
written out by the hub object. The type is for the template name. The
tree is for the main tree path or phylo object. The other parameters are
used relating to the different template types.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_group</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E1_template_types"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"TREE_COLORS"</span>, </span>
<span>                      subtype <span class="op">=</span> <span class="st">"clade"</span>, </span>
<span>                      line_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"normal"</span>,<span class="fl">4</span><span class="op">)</span>,<span class="st">"dashed"</span><span class="op">)</span>,</span>
<span>                      size_factor <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_count</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E2_parameter_number"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"DATASET_SYMBOL"</span>,</span>
<span>                      position <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unit_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_rename</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E3_template_rename"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"LABELS"</span>,</span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unit_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">template_groups</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E4_template_name_color"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"DATASET_STYLE"</span>, </span>
<span>                      subtype <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>                      position <span class="op">=</span> <span class="st">"node"</span>,</span>
<span>                      size_factor <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unit_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tab_tmp_connect</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E5_template_similarity"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"DATASET_CONNECTION"</span>, </span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unit_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">template_end_group_long</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E6_template_parameters_structure"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"DATASET_DOMAINS"</span>, </span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unit_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_group</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E7_template_types"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"DATASET_COLORSTRIP"</span>, </span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unit_8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_values</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E8_usage_count_among_publications"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"DATASET_HEATMAP"</span>, </span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unit_9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_value</span>, </span>
<span>                      key <span class="op">=</span> <span class="st">"E9_log_transformed_usage_count"</span>, </span>
<span>                      type <span class="op">=</span> <span class="st">"DATASET_BOXPLOT"</span>, </span>
<span>                      tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="theme-setup">Theme setup<a class="anchor" aria-label="anchor" href="#theme-setup"></a>
</h2>
<p>In the unit and hub object, we can change the theme setup. The theme
parameters in 23 templates have 114 kinds. We cluster the parameters
based on their function and specification.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unit_2</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">basic_plot</span><span class="op">$</span><span class="va">size_max</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span></span>
<span><span class="va">unit_5</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">basic_plot</span><span class="op">$</span><span class="va">size_max</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">unit_8</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="st">"#ffd966"</span></span>
<span><span class="va">unit_8</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="st">"#cc0000"</span></span>
<span><span class="va">unit_8</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">use_mid</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">unit_9</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">basic_plot</span><span class="op">$</span><span class="va">size_max</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="merge">Merge<a class="anchor" aria-label="anchor" href="#merge"></a>
</h2>
<p>For multi levels annotation, we can merge the units in one hub. This
hub object can be saved locally or output template files by the
<code>write_hub</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hub</span> <span class="op">&lt;-</span> <span class="va">hub</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_1</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_2</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_3</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_4</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_5</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_6</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_7</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_8</span> <span class="op">+</span> </span>
<span>  <span class="va">unit_9</span></span>
<span></span>
<span><span class="fu"><a href="../reference/write_hub.html">write_hub</a></span><span class="op">(</span><span class="va">hub</span>,<span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tong Zhou.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
