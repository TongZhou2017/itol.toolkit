<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DATASET_HEATMAP • itol.toolkit</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DATASET_HEATMAP">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">itol.toolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/Get_Start.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-single-functions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Single Functions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-single-functions">
<li><h6 class="dropdown-header" data-toc-skip>Tree Structure</h6></li>
    <li><a class="dropdown-item" href="../articles/COLLAPSE.html">COLLAPSE</a></li>
    <li><a class="dropdown-item" href="../articles/PRUNE.html">PRUNE</a></li>
    <li><a class="dropdown-item" href="../articles/SPACING.html">SPACING</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Theme Style</h6></li>
    <li><a class="dropdown-item" href="../articles/TREE_COLORS.html">TREE_COLORS</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_STYLE.html">DATASET_STYLE</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Text</h6></li>
    <li><a class="dropdown-item" href="../articles/LABELS.html">LABELS</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_TEXT.html">DATASET_TEXT</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_COLORSTRIP.html">DATASET_COLORSTRIP</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basic Plot</h6></li>
    <li><a class="dropdown-item" href="../articles/DATASET_BINARY.html">DATASET_BINARY</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_GRADIENT.html">DATASET_GRADIENT</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_HEATMAP.html">DATASET_HEATMAP</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_SYMBOL.html">DATASET_SYMBOL</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_EXTERNALSHAPE.html">DATASET_EXTERNALSHAPE</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_DOMAINS.html">DATASET_DOMAINS</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_SIMPLEBAR.html">DATASET_SIMPLEBAR</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_MULTIBAR.html">DATASET_MULTIBAR</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_BOXPLOT.html">DATASET_BOXPLOT</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_LINECHART.html">DATASET_LINECHART</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_PIECHART.html">DATASET_PIECHART</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Plot</h6></li>
    <li><a class="dropdown-item" href="../articles/DATASET_ALIGNMENT.html">DATASET_ALIGNMENT</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_CONNECTIONS.html">DATASET_CONNECTIONS</a></li>
    <li><a class="dropdown-item" href="../articles/DATASET_IMAGE.html">DATASET_IMAGE</a></li>
    <li><a class="dropdown-item" href="../articles/POPUP_INFO.html">POPUP_INFO</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tips" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tips</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tips">
<li><a class="dropdown-item" href="../articles/OVERVIEW_TREE_STRUCTURE.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/Installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/Datasets.html">Datasets</a></li>
    <li><a class="dropdown-item" href="../articles/Color_Palette.html">Colors</a></li>
    <li><a class="dropdown-item" href="../articles/Data_Reproduction.html">Data Reproduction</a></li>
    <li><a class="dropdown-item" href="../articles/Comparison_table2itol.html">vs table2itol</a></li>
    <li><a class="dropdown-item" href="../articles/tree_construction.html">Tree Construction</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Version history</h6></li>
    <li><a class="dropdown-item" href="../articles/v1.1.9.html">version 1.1.9</a></li>
    <li><a class="dropdown-item" href="../articles/v1.1.10.html">version 1.1.10</a></li>
    <li><a class="dropdown-item" href="../articles/v1.1.11.html">version 1.1.11</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://tongzhou2017.github.io/itol.toolkit-gallery/">Gallery</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TongZhou2017/itol.toolkit" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discord.com/invite/n5TC7jCfGJ" aria-label="Discord community"><span class="fa fab fa-discord fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/itol_toolkit" aria-label="Twitter profile"><span class="fa fa-twitter"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>DATASET_HEATMAP</h1>
                        <h4 data-toc-skip class="author">Weiyue Liu<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;IOCAS, &lt;a href="mailto:weiyLiu@outlook.com" class="email"&gt;weiyLiu@outlook.com&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>, Zhongyi
Hua<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;CACMS, &lt;a href="mailto:njbxhzy@hotmail.com" class="email"&gt;njbxhzy@hotmail.com&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>,
Tong Zhou<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;IOCAS, &lt;a href="mailto:tongzhou2017@gmail.com" class="email"&gt;tongzhou2017@gmail.com&lt;/a&gt;&lt;/p&gt;'><sup>3</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">Last compiled on 01
September, 2025</h4>
      

      <div class="d-none name"><code>DATASET_HEATMAP.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Through the <code>DATASET_HEATMAP</code> template, each tree tip is
associated to multiple numeric values, which are displayed as a set of
colored boxes (a heatmap). The <code>DATASET_HEATMAP</code> template
belongs to the “Basic plot” class (refer to the <a href="">Class</a> for
detail information).</p>
<p>This section shows how to use the <code>DATASET_HEATMAP</code>
template to draw a heatmap from multi-column wide data. Without
itol.toolkit, users would have to perform data analysis and
visualization preparation in different environments. The itol.toolkit
provides consistency to the workflow, enabling the user to perform data
processing and visualization preparation seamlessly.</p>
</div>
<div class="section level2">
<h2 id="drawing-heatmap">Drawing heatmap<a class="anchor" aria-label="anchor" href="#drawing-heatmap"></a>
</h2>
<p>This section uses <a href="https://github.com/TongZhou2017/itol.toolkit/tree/master/inst/extdata/dataset1" class="external-link">dataset
1</a> and <a href="https://github.com/TongZhou2017/itol.toolkit/tree/master/inst/extdata/dataset3" class="external-link">dataset
3</a> as examples to show the drawing of heatmap. (refer to the <a href="https://tongzhou2017.github.io/itol.toolkit/articles/Datasets.html">Dataset</a>
for detail information). Users can download the data locally from the
provided link above. The files are read using a relative path in this
document, so please adjust the path based on actual situation.</p>
<div class="section level3">
<h3 id="dataset-1">Dataset 1<a class="anchor" aria-label="anchor" href="#dataset-1"></a>
</h3>
<p>The first step is to load the <code>newick</code> format tree file
<code>tree_of_itol_templates.tree</code> and its corresponding metadata
<code>templates_frequence.txt</code>. The following example data
<code>templates_frequence.txt</code> contains the usage of each template
type in 21 published studies.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tongzhou2017.github.io/itol.toolkit/">itol.toolkit</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                    <span class="st">"tree_of_itol_templates.tree"</span>,</span>
<span>                    package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="va">df_frequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                            <span class="st">"templates_frequence.txt"</span>,</span>
<span>                             package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="va">df_frequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">df_frequence</span><span class="op">)</span></span></code></pre></div>
<p>By setting the <code>unit@specific_themes$heatmap$color$max</code>
and <code>unit@specific_themes$heatmap$color$min</code>, we can manually
control the colors corresponding to the maximum and minimum values. In
addition, there is a mid value for the default color setting, and we can
manually cancel setting the mid value:
<code>unit@specific_themes$heatmap$use_mid &lt;- 0</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unit_28</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_frequence</span>,</span>
<span>                       key <span class="op">=</span> <span class="st">"E028_heatmap_1"</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"DATASET_HEATMAP"</span>,</span>
<span>                       tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span><span class="va">unit_28</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="st">"#ffd966"</span></span>
<span><span class="va">unit_28</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="st">"#cc0000"</span></span>
<span><span class="va">unit_28</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">use_mid</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="../reference/write_unit.html">write_unit</a></span><span class="op">(</span><span class="va">unit_28</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="images/DATASET_HEATMAP_1.png" alt=""><p class="caption">Heatmap visualization example 1</p>
</div>
</div>
<div class="section level3">
<h3 id="dataset-3">Dataset 3<a class="anchor" aria-label="anchor" href="#dataset-3"></a>
</h3>
<p>The data in dataset3 comes from Lei Zheng et al. <em>Comparing with
oxygen, trate simplifies microbial community assembly and improve
functions as an electric acceptor in waste water treatment</em>,
published in 2022 in Environmental Pollution. This part will use a
heatmap to show the proportion of each community assembly process in
each bin. In the original text, the data is divided into two groups (NS
and OS). Here, we visualize the two groups of data respectively. The
files used below are read using a relative path in this document, so
please adjust the path based on actual situation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tongzhou2017.github.io/itol.toolkit/">itol.toolkit</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">tree_2_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                    <span class="st">"dataset3/assembly-tree.nwk"</span>,</span>
<span>                    package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="va">tree_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="va">tree_2_path</span><span class="op">)</span></span>
<span><span class="va">metadata_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                    <span class="st">"dataset3/assembly-metadata.txt"</span>,</span>
<span>                    package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="va">df_metadata</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">metadata_path</span><span class="op">)</span></span></code></pre></div>
<p>First, we prepare a heatmap drawing template using NS group data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_cap_NS</span> <span class="op">&lt;-</span> <span class="va">df_metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"NS"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"bar"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">unit_29a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_cap_NS</span>, </span>
<span>                       key <span class="op">=</span> <span class="st">"E029_heatmap_2a"</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"DATASET_HEATMAP"</span>, </span>
<span>                       tree <span class="op">=</span> <span class="va">tree_2</span><span class="op">)</span></span>
<span><span class="va">unit_29a</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="st">"#ffffff"</span></span>
<span><span class="va">unit_29a</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="st">"#8ccdd7"</span></span>
<span><span class="va">unit_29a</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">use_mid</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="../reference/write_unit.html">write_unit</a></span><span class="op">(</span><span class="va">unit_29a</span><span class="op">)</span></span></code></pre></div>
<p>Next, use the same method to visualize OS group data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_cap_OS</span> <span class="op">&lt;-</span> <span class="va">df_metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"OS"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"bar"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">unit_29b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_cap_OS</span>, </span>
<span>                       key <span class="op">=</span> <span class="st">"E029_heatmap_2b"</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"DATASET_HEATMAP"</span>, </span>
<span>                       tree <span class="op">=</span> <span class="va">tree_2</span><span class="op">)</span></span>
<span><span class="va">unit_29b</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="st">"#ffffff"</span></span>
<span><span class="va">unit_29b</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="st">"#f89b9b"</span></span>
<span><span class="va">unit_29b</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">use_mid</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="../reference/write_unit.html">write_unit</a></span><span class="op">(</span><span class="va">unit_29b</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="images/DATASET_HEATMAP_2.png" alt=""><p class="caption">Heatmap visualization example 2</p>
</div>
<p>It is worth noting that the column names of the data used to draw the
heatmap will be displayed on the side of the heatmap. Users should try
to avoid using special symbols in the column names, otherwise errors may
occur when applying the template to the iTOL: <em>Failed to decode the
file. Make sure it is in ASCII or UTF8 plain text format. Try using the
dataset templates available on iTOL’s help pages.</em></p>
</div>
</div>
<div class="section level2">
<h2 id="style-modification">Style modification<a class="anchor" aria-label="anchor" href="#style-modification"></a>
</h2>
<p>The program will generate a cluster tree based on heatmap data on the
side of the heat map by default. If you do not want to display the
cluster tree, you can modify it through
<code>unit@specific_themes$heatmap$tree$tree_display &lt;- 0</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unit_28</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">tree</span><span class="op">$</span><span class="va">tree_display</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">unit_29a</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">tree</span><span class="op">$</span><span class="va">tree_display</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">unit_29b</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">tree</span><span class="op">$</span><span class="va">tree_display</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<p>The maximum and minimum values of the heatmap can be set through
<code>unit_26@specific_themes$heatmap$value$max</code> and
<code>unit_26@specific_themes$heatmap$value$min</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unit_28</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">value</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">unit_28</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">value</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tong Zhou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
