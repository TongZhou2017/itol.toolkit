<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DATASET_HEATMAP • itol.toolkit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="DATASET_HEATMAP">
<meta property="og:description" content="itol.toolkit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">itol.toolkit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Get_Start.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Single Functions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Tree Structure</li>
    <li>
      <a href="../articles/COLLAPSE.html">COLLAPSE</a>
    </li>
    <li>
      <a href="../articles/PRUNE.html">PRUNE</a>
    </li>
    <li>
      <a href="../articles/SPACING.html">SPACING</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Theme Style</li>
    <li>
      <a href="../articles/TREE_COLORS.html">TREE_COLORS</a>
    </li>
    <li>
      <a href="../articles/DATASET_STYLE.html">DATASET_STYLE</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Text</li>
    <li>
      <a href="../articles/LABELS.html">LABELS</a>
    </li>
    <li>
      <a href="../articles/DATASET_TEXT.html">DATASET_TEXT</a>
    </li>
    <li>
      <a href="../articles/DATASET_COLORSTRIP.html">DATASET_COLORSTRIP</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Basic Plot</li>
    <li>
      <a href="../articles/DATASET_BINARY.html">DATASET_BINARY</a>
    </li>
    <li>
      <a href="../articles/DATASET_GRADIENT.html">DATASET_GRADIENT</a>
    </li>
    <li>
      <a href="../articles/DATASET_HEATMAP.html">DATASET_HEATMAP</a>
    </li>
    <li>
      <a href="../articles/DATASET_SYMBOL.html">DATASET_SYMBOL</a>
    </li>
    <li>
      <a href="../articles/DATASET_EXTERNALSHAPE.html">DATASET_EXTERNALSHAPE</a>
    </li>
    <li>
      <a href="../articles/DATASET_DOMAINS.html">DATASET_DOMAINS</a>
    </li>
    <li>
      <a href="../articles/DATASET_SIMPLEBAR.html">DATASET_SIMPLEBAR</a>
    </li>
    <li>
      <a href="../articles/DATASET_MULTIBAR.html">DATASET_MULTIBAR</a>
    </li>
    <li>
      <a href="../articles/DATASET_BOXPLOT.html">DATASET_BOXPLOT</a>
    </li>
    <li>
      <a href="../articles/DATASET_LINECHART.html">DATASET_LINECHART</a>
    </li>
    <li>
      <a href="../articles/DATASET_PIECHART.html">DATASET_PIECHART</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced Plot</li>
    <li>
      <a href="../articles/DATASET_ALIGNMENT.html">DATASET_ALIGNMENT</a>
    </li>
    <li>
      <a href="../articles/DATASET_CONNECTIONS.html">DATASET_CONNECTIONS</a>
    </li>
    <li>
      <a href="../articles/DATASET_IMAGE.html">DATASET_IMAGE</a>
    </li>
    <li>
      <a href="../articles/POPUP_INFO.html">POPUP_INFO</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tips
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/OVERVIEW_TREE_STRUCTURE.html">Overview</a>
    </li>
    <li>
      <a href="../articles/Installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/Datasets.html">Datasets</a>
    </li>
    <li>
      <a href="../articles/Color_Palette.html">Colors</a>
    </li>
    <li>
      <a href="../articles/Data_Reproduction.html">Data Reproduction</a>
    </li>
    <li>
      <a href="../articles/Comparison_table2itol.html">vs table2itol</a>
    </li>
    <li>
      <a href="../articles/tree_construction.html">Tree Construction</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://tongzhou2017.github.io/itol.toolkit-gallery/" class="external-link">Gallery</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TongZhou2017/itol.toolkit" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discord.com/invite/n5TC7jCfGJ" class="external-link">
    <span class="fab fa-discord fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/itol_toolkit" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>DATASET_HEATMAP</h1>
                        <h4 data-toc-skip class="author">Weiyue Liu<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, Zhongyi
Hua<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>,
Tong Zhou<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">Last compiled on 07 December,
2023</h4>
      
      
      <div class="hidden name"><code>DATASET_HEATMAP.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Through the <code>DATASET_HEATMAP</code> template, each tree tip is
associated to multiple numeric values, which are displayed as a set of
colored boxes (a heatmap). The <code>DATASET_HEATMAP</code> template
belongs to the “Basic plot” class (refer to the <a href="">Class</a> for
detail information).</p>
<p>This section shows how to use the <code>DATASET_HEATMAP</code>
template to draw a heatmap from multi-column wide data. Without
itol.toolkit, users would have to perform data analysis and
visualization preparation in different environments. The itol.toolkit
provides consistency to the workflow, enabling the user to perform data
processing and visualization preparation seamlessly.</p>
</div>
<div class="section level2">
<h2 id="drawing-heatmap">Drawing heatmap<a class="anchor" aria-label="anchor" href="#drawing-heatmap"></a>
</h2>
<p>This section uses <a href="https://github.com/TongZhou2017/itol.toolkit/tree/master/inst/extdata/dataset1" class="external-link">dataset
1</a> and <a href="https://github.com/TongZhou2017/itol.toolkit/tree/master/inst/extdata/dataset3" class="external-link">dataset
3</a> as examples to show the drawing of heatmap. (refer to the <a href="https://tongzhou2017.github.io/itol.toolkit/articles/Datasets.html" class="external-link">Dataset</a>
for detail information). Users can download the data locally from the
provided link above. The files are read using a relative path in this
document, so please adjust the path based on actual situation.</p>
<div class="section level3">
<h3 id="dataset-1">Dataset 1<a class="anchor" aria-label="anchor" href="#dataset-1"></a>
</h3>
<p>The first step is to load the <code>newick</code> format tree file
<code>tree_of_itol_templates.tree</code> and its corresponding metadata
<code>templates_frequence.txt</code>. The following example data
<code>templates_frequence.txt</code> contains the usage of each template
type in 21 published studies.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">itol.toolkit</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                    <span class="st">"tree_of_itol_templates.tree"</span>,</span>
<span>                    package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="va">df_frequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                            <span class="st">"templates_frequence.txt"</span>,</span>
<span>                             package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="va">df_frequence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">df_frequence</span><span class="op">)</span></span></code></pre></div>
<p>By setting the <code>unit@specific_themes$heatmap$color$max</code>
and <code>unit@specific_themes$heatmap$color$min</code>, we can manually
control the colors corresponding to the maximum and minimum values. In
addition, there is a mid value for the default color setting, and we can
manually cancel setting the mid value:
<code>unit@specific_themes$heatmap$use_mid &lt;- 0</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unit_25</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_frequence</span>,</span>
<span>                       key <span class="op">=</span> <span class="st">"E025_heatmap_1"</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"DATASET_HEATMAP"</span>,</span>
<span>                       tree <span class="op">=</span> <span class="va">tree</span><span class="op">)</span></span>
<span><span class="va">unit_25</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="st">"#ffd966"</span></span>
<span><span class="va">unit_25</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="st">"#cc0000"</span></span>
<span><span class="va">unit_25</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">use_mid</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="../reference/write_unit.html">write_unit</a></span><span class="op">(</span><span class="va">unit_25</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/DATASET_HEATMAP_1.png"></p>
</div>
<div class="section level3">
<h3 id="dataset-3">Dataset 3<a class="anchor" aria-label="anchor" href="#dataset-3"></a>
</h3>
<p>The data in dataset3 comes from Lei Zheng et al. <em>Comparing with
oxygen, trate simplifies microbial community assembly and improve
functions as an electric acceptor in waste water treatment</em>,
published in 2022 in Environmental Pollution. This part will use a
heatmap to show the proportion of each community assembly process in
each bin. In the original text, the data is divided into two groups (NS
and OS). Here, we visualize the two groups of data respectively. The
files used below are read using a relative path in this document, so
please adjust the path based on actual situation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">itol.toolkit</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">tree_2_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                    <span class="st">"dataset3/assembly-tree.nwk"</span>,</span>
<span>                    package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="va">tree_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="va">tree_2_path</span><span class="op">)</span></span>
<span><span class="va">metadata_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                    <span class="st">"dataset3/assembly-metadata.txt"</span>,</span>
<span>                    package <span class="op">=</span> <span class="st">"itol.toolkit"</span><span class="op">)</span></span>
<span><span class="va">df_metadata</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">metadata_path</span><span class="op">)</span></span></code></pre></div>
<p>First, we prepare a heatmap drawing template using NS group data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_cap_NS</span> <span class="op">&lt;-</span> <span class="va">df_metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"NS"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"bar"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">unit_26</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_cap_NS</span>, </span>
<span>                       key <span class="op">=</span> <span class="st">"Zheng2022ep_4a_heatmap_NS"</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"DATASET_HEATMAP"</span>, </span>
<span>                       tree <span class="op">=</span> <span class="va">tree_2</span><span class="op">)</span></span>
<span><span class="va">unit_26</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="st">"#ffffff"</span></span>
<span><span class="va">unit_26</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="st">"#8ccdd7"</span></span>
<span><span class="va">unit_26</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">use_mid</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="../reference/write_unit.html">write_unit</a></span><span class="op">(</span><span class="va">unit_26</span><span class="op">)</span></span></code></pre></div>
<p>Next, use the same method to visualize OS group data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_cap_OS</span> <span class="op">&lt;-</span> <span class="va">df_metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"OS"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"bar"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">unit_27</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_unit.html">create_unit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_cap_OS</span>, </span>
<span>                       key <span class="op">=</span> <span class="st">"Zheng2022ep_4a_heatmap_OS"</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"DATASET_HEATMAP"</span>, </span>
<span>                       tree <span class="op">=</span> <span class="va">tree_2</span><span class="op">)</span></span>
<span><span class="va">unit_27</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="st">"#ffffff"</span></span>
<span><span class="va">unit_27</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">color</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="st">"#f89b9b"</span></span>
<span><span class="va">unit_27</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">use_mid</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="../reference/write_unit.html">write_unit</a></span><span class="op">(</span><span class="va">unit_27</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/DATASET_HEATMAP_2.png"></p>
<p>It is worth noting that the column names of the data used to draw the
heatmap will be displayed on the side of the heatmap. Users should try
to avoid using special symbols in the column names, otherwise errors may
occur when applying the template to the iTOL: <em>Failed to decode the
file. Make sure it is in ASCII or UTF8 plain text format. Try using the
dataset templates available on iTOL’s help pages.</em></p>
</div>
</div>
<div class="section level2">
<h2 id="style-modification">Style modification<a class="anchor" aria-label="anchor" href="#style-modification"></a>
</h2>
<p>The program will generate a cluster tree based on heatmap data on the
side of the heat map by default. If you do not want to display the
cluster tree, you can modify it through
<code>unit@specific_themes$heatmap$tree$tree_display &lt;- 0</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unit_26</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">tree</span><span class="op">$</span><span class="va">tree_display</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">unit_27</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">tree</span><span class="op">$</span><span class="va">tree_display</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<p>The maximum and minimum values of the heatmap can be set through
<code>unit_26@specific_themes$heatmap$value$max</code> and
<code>unit_26@specific_themes$heatmap$value$min</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unit_26</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">value</span><span class="op">$</span><span class="va">max</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">unit_26</span><span class="op">@</span><span class="va">specific_themes</span><span class="op">$</span><span class="va">heatmap</span><span class="op">$</span><span class="va">value</span><span class="op">$</span><span class="va">min</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>IOCAS, <a href="mailto:weiyLiu@outlook.com" class="email">weiyLiu@outlook.com</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>CACMS, <a href="mailto:njbxhzy@hotmail.com" class="email">njbxhzy@hotmail.com</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>IOCAS, <a href="mailto:tongzhou2017@gmail.com" class="email">tongzhou2017@gmail.com</a><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tong Zhou.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
